keep_for_quests = [
    {"name": "Leaper Pulse Unit", "category": "ARC", "weight": 1, "value": 5000, "quantity": "1x", "total_value": 5000},
    {"name": "Power Rod", "category": "Exodus", "weight": 1, "value": 5500, "quantity": "1x", "total_value": 5500},
    {"name": "Rocketeer Driver", "category": "ARC", "weight": 1, "value": 5000, "quantity": "1x", "total_value": 5000},
    {"name": "Surveyor Vault", "category": "ARC", "weight": 0.75, "value": 2000, "quantity": "2x", "total_value": 4000},
    {"name": "Antiseptic", "category": "Medical", "weight": 1, "value": 1000, "quantity": "2x", "total_value": 2000},
    {"name": "Hornet Driver", "category": "ARC", "weight": 0.75, "value": 2000, "quantity": "1x", "total_value": 2000},
    {"name": "Syringe", "category": "Medical", "weight": 0.3, "value": 500, "quantity": "2x", "total_value": 1000},
    {"name": "Wasp Driver", "category": "ARC", "weight": 0.6, "value": 1000, "quantity": "1x", "total_value": 1000},
    {"name": "Water Pump", "category": "Mechanical/Industrial", "weight": 2, "value": 640, "quantity": "2x", "total_value": 1280},
    {"name": "Snitch Scanner", "category": "ARC", "weight": 0.75, "value": 2000, "quantity": "3x", "total_value": 6000},
    {"name": "ARC Powercell", "category": "ARC", "weight": 0.25, "value": 640, "quantity": "1x", "total_value": 640},
    {"name": "Camera Lens", "category": "Recyclable", "weight": 0.8, "value": 270, "quantity": "1x", "total_value": 270},
    {"name": "Deflated Football", "category": "Residential", "weight": 0.8, "value": 1000, "quantity": "1x", "total_value": 1000},
    {"name": "Duct Tape", "category": "Topside Material", "weight": 0.5, "value": 300, "quantity": "1x", "total_value": 300},
    {"name": "Empty Wine Bottle", "category": "Trinket", "weight": 0.5, "value": 1000, "quantity": "1x", "total_value": 1000},
    {"name": "Faded Photograph", "category": "Trinket", "weight": 0.1, "value": 640, "quantity": "2x", "total_value": 1280},
    {"name": "Film Reel", "category": "Trinket", "weight": 1, "value": 2000, "quantity": "1x", "total_value": 2000},
    {"name": "Flute", "category": "Residential", "weight": 2, "value": 640, "quantity": "1x", "total_value": 640},
    {"name": "Oil", "category": "Topside Material", "weight": 0.5, "value": 300, "quantity": "1x", "total_value": 300},
    {"name": "Rubber Duck", "category": "Trinket", "weight": 0.3, "value": 1000, "quantity": "2x", "total_value": 2000},
    {"name": "Sensors", "category": "Topside Material", "weight": 0.3, "value": 500, "quantity": "3x", "total_value": 1500},
    {"name": "Tick Pod", "category": "ARC", "weight": 0.3, "value": 640, "quantity": "8x", "total_value": 5120},
    {"name": "Water Filter", "category": "Industrial", "weight": 2, "value": 640, "quantity": "1x", "total_value": 640}
]

keep_for_projects = [
    {"name": "Leaper Pulse Unit", "category": "ARC", "weight": 1, "value": 5000, "quantity": "3x", "total_value": 15000},
    {"name": "Magnetic Accelerator", "category": "Exodus", "weight": 1, "value": 5500, "quantity": "3x", "total_value": 16500},
    {"name": "Exodus Modules", "category": "Exodus", "weight": 1, "value": 2750, "quantity": "1x", "total_value": 2750},
    {"name": "Adv. Electrical Components", "category": "ARC", "weight": 1, "value": 3000, "quantity": "5x", "total_value": 15000},
    {"name": "Humidifier", "category": "Residential", "weight": 2, "value": 542, "quantity": "5x", "total_value": 2710},
    {"name": "Sensors", "category": "Topside Material", "weight": 0.3, "value": 500, "quantity": "20x", "total_value": 10000},
    {"name": "Cooling Fan", "category": "Recyclable", "weight": 3, "value": 1000, "quantity": "5x", "total_value": 5000},
    {"name": "Battery", "category": "Topside Material", "weight": 0.25, "value": 250, "quantity": "30x", "total_value": 7500},
    {"name": "Light Bulb", "category": "Trinket", "weight": 0.2, "value": 2000, "quantity": "5x", "total_value": 10000},
    {"name": "Electrical Components", "category": "Refined Material", "weight": 0.5, "value": 2000, "quantity": "30x", "total_value": 60000},
    {"name": "Wires", "category": "Topside Material", "weight": 0.25, "value": 200, "quantity": "30x", "total_value": 6000},
    {"name": "Steel Spring", "category": "Topside Material", "weight": 0.25, "value": 300, "quantity": "15x", "total_value": 4500},
    {"name": "Fabric", "category": "Basic Material", "weight": 0.1, "value": 50, "quantity": "35x", "total_value": 1750},
    {"name": "ARC Alloy", "category": "Topside Material", "weight": 0.25, "value": 250, "quantity": "80x", "total_value": 20000},
    {"name": "Rubber Parts", "category": "Basic Material", "weight": 0.1, "value": 50, "quantity": "150x", "total_value": 7500},
    {"name": "Metal Parts", "category": "Basic Material", "weight": 0.1, "value": 75, "quantity": "200x", "total_value": 15000}
]

safe_to_recycle = [
    {"name": "Accordion", "category": "Residential", "weight": 3, "value": 2000},
    {"name": "Air Freshener", "category": "Trinket", "weight": 1, "value": 2000},
    {"name": "Alarm Clock", "category": "Residential", "weight": 2, "value": 640},
    {"name": "ARC Coolant", "category": "ARC", "weight": 1, "value": 1000},
    {"name": "ARC Flex Rubber", "category": "ARC", "weight": 1, "value": 1000},
    {"name": "ARC Performance Steel", "category": "ARC", "weight": 1, "value": 1000},
    {"name": "ARC Synthetic Resin", "category": "ARC", "weight": 1, "value": 1000},
    {"name": "ARC Thermo Lining", "category": "ARC", "weight": 1, "value": 1000},
    {"name": "Bicycle Pump", "category": "Residential", "weight": 3, "value": 1000},
    {"name": "Bloated Tuna Can", "category": "Trinket", "weight": 0.5, "value": 1000},
    {"name": "Breathtaking Snow Globe", "category": "Trinket", "weight": 1, "value": 7000},
    {"name": "Broken Flashlight", "category": "Security", "weight": 2, "value": 952},
    {"name": "Broken Guidance System", "category": "Industrial", "weight": 3, "value": 2000},
    {"name": "Broken Handheld Radio", "category": "Security", "weight": 3, "value": 1000},
    {"name": "Broken Handcuffs", "category": "Security", "weight": 0.8, "value": 270},
    {"name": "Broken Riot Shield", "category": "Security", "weight": 2, "value": 1000},
    {"name": "Broken Taser", "category": "Security", "weight": 2, "value": 640},
    {"name": "Burned ARC Circuitry", "category": "ARC", "weight": 0.25, "value": 640},
    {"name": "Candle Holder", "category": "Residential", "weight": 2, "value": 270},
    {"name": "Coffee Pot", "category": "Trinket", "weight": 2, "value": 2000},
    {"name": "Coolant", "category": "Mechanical", "weight": 2, "value": 640},
    {"name": "Cooling Coil", "category": "Industrial", "weight": 2, "value": 640},
    {"name": "Crumpled Plastic Bottle", "category": "Residential", "weight": 0.8, "value": 80},
    {"name": "Damaged ARC Motion Core", "category": "ARC", "weight": 0.25, "value": 640},
    {"name": "Damaged ARC Powercell", "category": "ARC", "weight": 0.25, "value": 293},
    {"name": "Damaged Fireball Burner", "category": "ARC", "weight": 0.25, "value": 270},
    {"name": "Damaged Rocketeer Part", "category": "ARC", "weight": 0.5, "value": 2000},
    {"name": "Damaged Wasp Driver", "category": "ARC", "weight": 0.25, "value": 270},
    {"name": "Dartboard", "category": "Trinket", "weight": 2, "value": 2000},
    {"name": "Degraded ARC Rubber", "category": "ARC", "weight": 0.5, "value": 640},
    {"name": "Diving Goggles", "category": "Residential", "weight": 2, "value": 640},
    {"name": "Dried-Out ARC Resin", "category": "ARC", "weight": 1, "value": 640},
    {"name": "Expired Pasta", "category": "Trinket", "weight": 0.5, "value": 1000},
    {"name": "Expired Respirator", "category": "Medical", "weight": 2, "value": 640},
    {"name": "Fine Wristwatch", "category": "Trinket", "weight": 0.5, "value": 3000},
    {"name": "Frying Pan", "category": "Residential", "weight": 2, "value": 270},
    {"name": "Garlic Press", "category": "Commercial/Residential", "weight": 0.8, "value": 640},
    {"name": "Headphones", "category": "Commercial/Residential", "weight": 2, "value": 640},
    {"name": "Household Cleaner", "category": "Residential", "weight": 0.8, "value": 270},
    {"name": "Ice Cream Scooper", "category": "Commercial", "weight": 0.8, "value": 270},
    {"name": "Impure ARC Coolant", "category": "ARC", "weight": 1, "value": 640},
    {"name": "Industrial Charger", "category": "Industrial", "weight": 2, "value": 640},
    {"name": "Industrial Magnet", "category": "Industrial", "weight": 2, "value": 640},
    {"name": "Lance's Mixtape (5th Edition)", "category": "Trinket", "weight": 0.3, "value": 10000},
    {"name": "Metal Brackets", "category": "Mechanical/Electrical", "weight": 0.8, "value": 270},
    {"name": "Music Album", "category": "Trinket", "weight": 0.5, "value": 3000},
    {"name": "Music Box", "category": "Trinket", "weight": 1, "value": 5000},
    {"name": "Number Plate", "category": "Mechanical", "weight": 0.8, "value": 80},
    {"name": "Painted Box", "category": "Trinket", "weight": 1, "value": 2000},
    {"name": "Playing Cards", "category": "Trinket", "weight": 0.2, "value": 5000},
    {"name": "Polluted Air Filter", "category": "Industrial", "weight": 0.8, "value": 640},
    {"name": "Portable TV", "category": "Residential", "weight": 3, "value": 1000},
    {"name": "Poster of Natural Wonders", "category": "Trinket", "weight": 0.5, "value": 2000},
    {"name": "Pottery", "category": "Trinket", "weight": 1, "value": 2000},
    {"name": "Power Bank", "category": "Electrical/Residential/Commercial", "weight": 2, "value": 640},
    {"name": "Projector", "category": "Residential", "weight": 2, "value": 640},
    {"name": "Radio", "category": "Commercial/Residential", "weight": 2, "value": 640},
    {"name": "Red Coral Jewelry", "category": "Trinket", "weight": 0.5, "value": 5000},
    {"name": "Remote Control", "category": "Residential", "weight": 0.8, "value": 270},
    {"name": "Ripped Safety Vest", "category": "Industrial", "weight": 0.8, "value": 1000},
    {"name": "Rosary", "category": "Trinket", "weight": 0.2, "value": 2000},
    {"name": "Rubber Pad", "category": "Electrical", "weight": 2, "value": 640},
    {"name": "Ruined Accordion", "category": "Residential", "weight": 3, "value": 2000},
    {"name": "Ruined Baton", "category": "Security", "weight": 0.8, "value": 640},
    {"name": "Ruined Handcuffs", "category": "Security", "weight": 0.8, "value": 640},
    {"name": "Ruined Parachute", "category": "Exodus", "weight": 0.8, "value": 640},
    {"name": "Ruined Riot Shield", "category": "Security", "weight": 2, "value": 1000},
    {"name": "Ruined Tactical Vest", "category": "Security", "weight": 0.8, "value": 640},
    {"name": "Rusted Bolts", "category": "Mechanical/Industrial", "weight": 0.8, "value": 640},
    {"name": "Rusty ARC Steel", "category": "ARC", "weight": 1, "value": 640},
    {"name": "Silver Teaspoon Set", "category": "Trinket", "weight": 0.5, "value": 3000},
    {"name": "Spotter Relay", "category": "ARC", "weight": 1, "value": 5000},
    {"name": "Spring Cushion", "category": "Commercial/Residential", "weight": 2, "value": 640},
    {"name": "Statuette", "category": "Trinket", "weight": 1, "value": 3000},
    {"name": "Tattered ARC Lining", "category": "ARC", "weight": 1, "value": 640},
    {"name": "Tattered Clothes", "category": "Residential", "weight": 0.8, "value": 270},
    {"name": "Thermostat", "category": "Residential", "weight": 2, "value": 640},
    {"name": "Torn Blanket", "category": "Residential/Medical", "weight": 2, "value": 640},
    {"name": "Vase", "category": "Trinket", "weight": 1, "value": 3000}
]

# Nature/Misc items (cannot be recycled)
nature_and_misc = [
    {"name": "Agave", "category": "Nature", "weight": 0.5, "value": 1000},
    {"name": "Apricot", "category": "Nature", "weight": 0.3, "value": 640},
    {"name": "Fertilizer", "category": "Nature", "weight": 1, "value": 1000},
    {"name": "Lemon", "category": "Nature", "weight": 0.3, "value": 640},
    {"name": "Mushroom", "category": "Nature", "weight": 0.4, "value": 1000},
    {"name": "Olives", "category": "Nature", "weight": 0.3, "value": 640},
    {"name": "Prickly Pear", "category": "Nature", "weight": 0.3, "value": 640},
    {"name": "Resin", "category": "Nature", "weight": 0.5, "value": 500},
    {"name": "Roots", "category": "Nature", "weight": 0.5, "value": 500},
    {"name": "Volcanic Rock", "category": "Nature", "weight": 1, "value": 500}
]

# Topside/Crafting Materials
crafting_materials = [
    {"name": "ARC Alloy", "category": "Topside Material", "weight": 0.25, "value": 250},
    {"name": "ARC Circuitry", "category": "Topside Material", "weight": 0.5, "value": 1000},
    {"name": "ARC Motion Core", "category": "Topside Material", "weight": 0.5, "value": 1000},
    {"name": "Battery", "category": "Topside Material", "weight": 0.25, "value": 250},
    {"name": "Canister", "category": "Topside Material", "weight": 0.3, "value": 300},
    {"name": "Chemicals", "category": "Basic Material", "weight": 0.1, "value": 50},
    {"name": "Fabric", "category": "Basic Material", "weight": 0.1, "value": 50},
    {"name": "Magnet", "category": "Topside Material", "weight": 0.3, "value": 300},
    {"name": "Metal Parts", "category": "Basic Material", "weight": 0.1, "value": 75},
    {"name": "Metal Plate", "category": "Topside Material", "weight": 0.5, "value": 300},
    {"name": "Moss", "category": "Topside Material", "weight": 0.3, "value": 500},
    {"name": "Oil", "category": "Topside Material", "weight": 0.5, "value": 300},
    {"name": "Plastic Parts", "category": "Basic Material", "weight": 0.1, "value": 60},
    {"name": "Processor", "category": "Topside Material", "weight": 0.5, "value": 500},
    {"name": "Rope", "category": "Topside Material", "weight": 0.3, "value": 500},
    {"name": "Rubber Parts", "category": "Basic Material", "weight": 0.1, "value": 50},
    {"name": "Sensors", "category": "Topside Material", "weight": 0.3, "value": 500},
    {"name": "Simple Gun Parts", "category": "Topside Material", "weight": 0.5, "value": 330},
    {"name": "Speaker Component", "category": "Topside Material", "weight": 0.3, "value": 500},
    {"name": "Steel Spring", "category": "Topside Material", "weight": 0.25, "value": 300},
    {"name": "Torch Ginger", "category": "Topside Material", "weight": 0.3, "value": 300},
    {"name": "Voltage Converter", "category": "Topside Material", "weight": 0.3, "value": 500},
    {"name": "Wires", "category": "Topside Material", "weight": 0.25, "value": 200},
    {"name": "Light Gun Parts", "category": "Topside Material", "weight": 0.5, "value": 700},
    {"name": "Medium Gun Parts", "category": "Topside Material", "weight": 0.5, "value": 700},
    {"name": "Shotgun Parts", "category": "Topside Material", "weight": 0.5, "value": 700},
    {"name": "Heavy Gun Parts", "category": "Topside Material", "weight": 0.5, "value": 700}
]

# Refined/Advanced Materials
advanced_materials = [
    {"name": "Adv. Electrical Components", "category": "Advanced Material", "weight": 1, "value": 3000},
    {"name": "Adv. Mechanical Components", "category": "Advanced Material", "weight": 1, "value": 3000},
    {"name": "Antiseptic", "category": "Refined Material", "weight": 1, "value": 1000},
    {"name": "Electrical Components", "category": "Refined Material", "weight": 0.5, "value": 2000},
    {"name": "Explosive Mixture", "category": "Refined Material", "weight": 1, "value": 1000},
    {"name": "Mechanical Components", "category": "Refined Material", "weight": 1, "value": 2000},
    {"name": "Mod Components", "category": "Advanced Material", "weight": 1, "value": 3000},
    {"name": "Synthesized Fuel", "category": "Topside Material", "weight": 0.5, "value": 700}
]

workshop_upgrades = {
    "Scrappy Level 2": [
        {"name": "Dog Collar", "category": "Residential", "weight": 0.5, "value": 270, "quantity": "1x", "total_value": 270},
        {"name": "Lemon", "category": "Nature", "weight": 0.3, "value": 640, "quantity": "3x", "total_value": 1920},
        {"name": "Apricot", "category": "Nature", "weight": 0.3, "value": 640, "quantity": "3x", "total_value": 1920}
    ],
    "Scrappy Level 3": [
        {"name": "Prickly Pear", "category": "Nature", "weight": 0.3, "value": 640, "quantity": "6x", "total_value": 3840},
        {"name": "Olives", "category": "Nature", "weight": 0.3, "value": 640, "quantity": "6x", "total_value": 3840},
        {"name": "Cat Bed", "category": "Trinket", "weight": 1, "value": 1000, "quantity": "1x", "total_value": 1000}
    ],
    "Scrappy Level 4": [
        {"name": "Mushroom", "category": "Nature", "weight": 0.4, "value": 1000, "quantity": "12x", "total_value": 12000},
        {"name": "Apricot", "category": "Nature", "weight": 0.3, "value": 640, "quantity": "12x", "total_value": 7680}
    ],
    "Scrappy Level 5": [
        {"name": "Very Comfortable Pillow", "category": "Trinket", "weight": 1, "value": 2000, "quantity": "3x", "total_value": 6000}
    ],
    "Gunsmith Level 2": [
        {"name": "Rusted Tools", "category": "Recyclable", "weight": 2, "value": 640, "quantity": "3x", "total_value": 1920},
        {"name": "Wasp Driver", "category": "ARC", "weight": 0.6, "value": 1000, "quantity": "8x", "total_value": 8000},
        {"name": "Mechanical Components", "category": "Refined Material", "weight": 1, "value": 2000, "quantity": "5x", "total_value": 10000}
    ],
    "Gunsmith Level 3": [
        {"name": "Rusted Gear", "category": "Recyclable", "weight": 2, "value": 1000, "quantity": "3x", "total_value": 3000},
        {"name": "Adv. Mechanical Components", "category": "Advanced Material", "weight": 1, "value": 3000, "quantity": "5x", "total_value": 15000},
        {"name": "Sentinel Core", "category": "Recyclable", "weight": 1, "value": 3000, "quantity": "4x", "total_value": 12000}
    ],
    "Gear Bench Level 2": [
        {"name": "Power Cable", "category": "Recyclable", "weight": 1, "value": 640, "quantity": "3x", "total_value": 1920},
        {"name": "Electrical Components", "category": "Refined Material", "weight": 0.5, "value": 2000, "quantity": "5x", "total_value": 10000},
        {"name": "Hornet Driver", "category": "ARC", "weight": 0.75, "value": 2000, "quantity": "5x", "total_value": 10000}
    ],
    "Gear Bench Level 3": [
        {"name": "Industrial Battery", "category": "Recyclable", "weight": 2, "value": 640, "quantity": "3x", "total_value": 1920},
        {"name": "Adv. Electrical Components", "category": "Advanced Material", "weight": 1, "value": 3000, "quantity": "5x", "total_value": 15000},
        {"name": "Bastion Part", "category": "Recyclable", "weight": 1, "value": 3000, "quantity": "6x", "total_value": 18000}
    ],
    "Medical Lab Level 2": [
        {"name": "Cracked Bioscanner", "category": "Recyclable", "weight": 2, "value": 640, "quantity": "2x", "total_value": 1280},
        {"name": "Tick Pod", "category": "ARC", "weight": 0.3, "value": 640, "quantity": "8x", "total_value": 5120},
        {"name": "Fabric", "category": "Basic Material", "weight": 0.1, "value": 50, "quantity": "5x", "total_value": 250}
    ],
    "Medical Lab Level 3": [
        {"name": "Rusted Shut Medical Kit", "category": "Recyclable", "weight": 2, "value": 1000, "quantity": "3x", "total_value": 3000},
        {"name": "Antiseptic", "category": "Refined Material", "weight": 1, "value": 1000, "quantity": "8x", "total_value": 8000},
        {"name": "Surveyor Vault", "category": "ARC", "weight": 0.75, "value": 2000, "quantity": "5x", "total_value": 10000}
    ],
    "Refiner Level 2": [
        {"name": "Toaster", "category": "Recyclable", "weight": 2, "value": 640, "quantity": "3x", "total_value": 1920},
        {"name": "Fireball Burner", "category": "Recyclable", "weight": 0.5, "value": 640, "quantity": "8x", "total_value": 5120},
        {"name": "ARC Motion Core", "category": "Topside Material", "weight": 0.5, "value": 1000, "quantity": "5x", "total_value": 5000}
    ],
    "Refiner Level 3": [
        {"name": "Motor", "category": "Recyclable", "weight": 2, "value": 1000, "quantity": "3x", "total_value": 3000},
        {"name": "ARC Circuitry", "category": "Topside Material", "weight": 0.5, "value": 1000, "quantity": "10x", "total_value": 10000},
        {"name": "Bombardier Part", "category": "Recyclable", "weight": 1, "value": 5000, "quantity": "6x", "total_value": 30000}
    ],
    "Explosives Station Level 2": [
        {"name": "Synthesized Fuel", "category": "Topside Material", "weight": 0.5, "value": 700, "quantity": "3x", "total_value": 2100},
        {"name": "Pop Trigger", "category": "ARC", "weight": 0.3, "value": 640, "quantity": "5x", "total_value": 3200},
        {"name": "Crude Explosives", "category": "Industrial/Security", "weight": 0.5, "value": 270, "quantity": "5x", "total_value": 1350}
    ],
    "Explosives Station Level 3": [
        {"name": "Laboratory Reagents", "category": "Recyclable", "weight": 1, "value": 1000, "quantity": "3x", "total_value": 3000},
        {"name": "Explosive Mixture", "category": "Refined Material", "weight": 1, "value": 1000, "quantity": "5x", "total_value": 5000},
        {"name": "Rocketeer Part", "category": "Recyclable", "weight": 1, "value": 7000, "quantity": "3x", "total_value": 21000}
    ],
    "Utility Station Level 2": [
        {"name": "Damaged Heat Sink", "category": "Recyclable", "weight": 2, "value": 640, "quantity": "2x", "total_value": 1280},
        {"name": "Snitch Scanner", "category": "ARC", "weight": 0.75, "value": 2000, "quantity": "6x", "total_value": 12000},
        {"name": "Electrical Components", "category": "Refined Material", "weight": 0.5, "value": 2000, "quantity": "5x", "total_value": 10000}
    ],
    "Utility Station Level 3": [
        {"name": "Fried Motherboard", "category": "Recyclable", "weight": 2, "value": 1000, "quantity": "3x", "total_value": 3000},
        {"name": "Adv. Electrical Components", "category": "Advanced Material", "weight": 1, "value": 3000, "quantity": "5x", "total_value": 15000},
        {"name": "Leaper Pulse Unit", "category": "ARC", "weight": 1, "value": 5000, "quantity": "4x", "total_value": 20000}
    ]
}


def get_workshop_items():
    """Returns all items from workshop upgrades with their workshop location."""
    results = []
    
    for workshop, items in workshop_upgrades.items():
        for item in items:
            results.append({"location": f"Workshop: {workshop}", **item})
    
    return results


def search_item(query):
    """Search for items across all categories."""
    query_lower = query.lower()
    results = []
    
    for item in keep_for_quests:
        if query_lower in item["name"].lower():
            results.append({"location": "Keep for Quests", **item})
    
    for item in keep_for_projects:
        if query_lower in item["name"].lower():
            results.append({"location": "Keep for Projects", **item})
    
    for item in safe_to_recycle:
        if query_lower in item["name"].lower():
            results.append({"location": "Safe to Recycle", **item})
    
    for item in nature_and_misc:
        if query_lower in item["name"].lower():
            results.append({"location": "Nature/Misc (Cannot Recycle)", **item})
    
    for item in crafting_materials:
        if query_lower in item["name"].lower():
            results.append({"location": "Crafting Materials", **item})
    
    for item in advanced_materials:
        if query_lower in item["name"].lower():
            results.append({"location": "Advanced/Refined Materials", **item})
    
    for workshop, items in workshop_upgrades.items():
        for item in items:
            if query_lower in item["name"].lower():
                results.append({"location": f"Workshop: {workshop}", **item})
    
    return results


def get_all_items():
    """Returns all items from all categories."""
    all_items = []
    
    for item in keep_for_quests:
        all_items.append({"location": "Keep for Quests", **item})
    
    for item in keep_for_projects:
        all_items.append({"location": "Keep for Projects", **item})
    
    for item in safe_to_recycle:
        all_items.append({"location": "Safe to Recycle", **item})
    
    for item in nature_and_misc:
        all_items.append({"location": "Nature/Misc", **item})
    
    for item in crafting_materials:
        all_items.append({"location": "Crafting Materials", **item})
    
    for item in advanced_materials:
        all_items.append({"location": "Advanced/Refined Materials", **item})
    
    for workshop, items in workshop_upgrades.items():
        for item in items:
            all_items.append({"location": f"Workshop: {workshop}", **item})
    
    return all_items


def calculate_total_value(items):
    """Calculate the total value of a list of items."""
    total = 0
    for item in items:
        if "total_value" in item:
            total += item["total_value"]
        elif "quantity" in item:
            qty = int(item["quantity"].replace("x", ""))
            total += item["value"] * qty
        else:
            total += item["value"]
    return total
